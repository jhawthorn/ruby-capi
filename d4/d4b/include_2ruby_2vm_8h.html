<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ruby: include/ruby/vm.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Ruby<span id="projectnumber">&#160;3.2.0dev (2022-06-11 revision 0e2c01bd094617f5c82759bdab03bb786ce89d56)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_82434f6a8a39055b35115fc8d4134985.html">ruby</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">vm.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<h3 class="version">(072d74cc7aa710cf1d8e42c661bdf6c84ead1c82)</h3><div class="textblock"><code>#include &quot;<a class="el" href="../../db/de3/dllexport_8h_source.html">ruby/internal/dllexport.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for vm.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d90/include_2ruby_2vm_8h__incl.png" border="0" usemap="#ainclude_2ruby_2vm_8h" alt=""/></div>
<map name="ainclude_2ruby_2vm_8h" id="ainclude_2ruby_2vm_8h">
<area shape="rect" title=" " alt="" coords="297,5,433,32"/>
<area shape="rect" href="../../db/de3/dllexport_8h.html" title="Tweaking visibility of C variables/functions." alt="" coords="277,80,453,107"/>
<area shape="rect" href="../../db/d16/config_8h_source.html" title=" " alt="" coords="227,155,386,181"/>
<area shape="rect" href="../../df/dec/compiler__is_8h.html" title="Defines RBIMPL_COMPILER_IS." alt="" coords="203,319,394,345"/>
<area shape="rect" title=" " alt="" coords="280,237,387,263"/>
<area shape="rect" href="../../dc/db4/compiler__since_8h.html" title="Defines RBIMPL_COMPILER_SINCE." alt="" coords="93,229,256,271"/>
<area shape="rect" href="../../d2/d6e/apple_8h_source.html" title=" " alt="" coords="311,572,473,613"/>
<area shape="rect" href="../../de/dbb/clang_8h_source.html" title=" " alt="" coords="192,483,355,524"/>
<area shape="rect" href="../../d4/d99/gcc_8h_source.html" title=" " alt="" coords="277,393,440,435"/>
<area shape="rect" href="../../d5/d80/intel_8h_source.html" title=" " alt="" coords="5,483,168,524"/>
<area shape="rect" href="../../d4/dac/msvc_8h_source.html" title=" " alt="" coords="40,393,203,435"/>
<area shape="rect" href="../../da/d2d/sunpro_8h_source.html" title=" " alt="" coords="515,393,677,435"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d38/include_2ruby_2vm_8h__dep__incl.png" border="0" usemap="#ainclude_2ruby_2vm_8hdep" alt=""/></div>
<map name="ainclude_2ruby_2vm_8hdep" id="ainclude_2ruby_2vm_8hdep">
<area shape="rect" title=" " alt="" coords="43,5,179,32"/>
<area shape="rect" href="../../d3/d57/eval_8c_source.html" title=" " alt="" coords="5,80,61,107"/>
<area shape="rect" href="../../de/de9/vm_8c_source.html" title=" " alt="" coords="85,80,136,107"/>
<area shape="rect" href="../../d5/df2/win32_8c_source.html" title=" " alt="" coords="161,80,271,107"/>
</map>
</div>
</div>
<p><a href="../../d4/d4b/include_2ruby_2vm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afd6d6bfc5b87b128cc4b33c5b259b01a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../db/d74/structrb__vm__struct.html">rb_vm_struct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4b/include_2ruby_2vm_8h.html#afd6d6bfc5b87b128cc4b33c5b259b01a">ruby_vm_t</a></td></tr>
<tr class="memdesc:afd6d6bfc5b87b128cc4b33c5b259b01a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The opaque struct to hold VM internals.  <a href="../../d4/d4b/include_2ruby_2vm_8h.html#afd6d6bfc5b87b128cc4b33c5b259b01a">More...</a><br /></td></tr>
<tr class="separator:afd6d6bfc5b87b128cc4b33c5b259b01a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a64b7830f0ac2f5c4e03c3659051b3e4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4b/include_2ruby_2vm_8h.html#a64b7830f0ac2f5c4e03c3659051b3e4b">ruby_vm_destruct</a> (<a class="el" href="../../db/d74/structrb__vm__struct.html">ruby_vm_t</a> *vm)</td></tr>
<tr class="memdesc:a64b7830f0ac2f5c4e03c3659051b3e4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructs the passed VM.  <a href="../../d4/d4b/include_2ruby_2vm_8h.html#a64b7830f0ac2f5c4e03c3659051b3e4b">More...</a><br /></td></tr>
<tr class="separator:a64b7830f0ac2f5c4e03c3659051b3e4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450d06a010ca9e1139e5ba87c5cb9e38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4b/include_2ruby_2vm_8h.html#a450d06a010ca9e1139e5ba87c5cb9e38">ruby_vm_at_exit</a> (void(*func)(<a class="el" href="../../db/d74/structrb__vm__struct.html">ruby_vm_t</a> *))</td></tr>
<tr class="memdesc:a450d06a010ca9e1139e5ba87c5cb9e38"><td class="mdescLeft">&#160;</td><td class="mdescRight">ruby_vm_at_exit registers a function <em>func</em> to be invoked when a VM passed away.  <a href="../../d4/d4b/include_2ruby_2vm_8h.html#a450d06a010ca9e1139e5ba87c5cb9e38">More...</a><br /></td></tr>
<tr class="separator:a450d06a010ca9e1139e5ba87c5cb9e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>$Author$ </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Sat May 31 15:17:36 2008 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (C) 2008 Yukihiro Matsumoto </dd>
<dd>
This file is a part of the programming language Ruby. Permission is hereby granted, to either redistribute and/or modify this file, provided that the conditions mentioned in the file COPYING are met. Consult the file for details.</dd></dl>
<p>We planned to have multiple VMs run side-by-side. The API here was a preparation of that feature. The topic branch was eventually abandoned, and we now have Ractor. This file is kind of obsolescent. </p>

<p class="definition">Definition in file <a class="el" href="../../d4/d4b/include_2ruby_2vm_8h_source.html">vm.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="afd6d6bfc5b87b128cc4b33c5b259b01a" name="afd6d6bfc5b87b128cc4b33c5b259b01a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd6d6bfc5b87b128cc4b33c5b259b01a">&#9670;&nbsp;</a></span>ruby_vm_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../db/d74/structrb__vm__struct.html">rb_vm_struct</a> <a class="el" href="../../db/d74/structrb__vm__struct.html">ruby_vm_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The opaque struct to hold VM internals. </p>
<p >Its fields are intentionally hidden from extension libraries because it changes drastically time to time. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d4b/include_2ruby_2vm_8h_source.html#l00025">25</a> of file <a class="el" href="../../d4/d4b/include_2ruby_2vm_8h_source.html">vm.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a450d06a010ca9e1139e5ba87c5cb9e38" name="a450d06a010ca9e1139e5ba87c5cb9e38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a450d06a010ca9e1139e5ba87c5cb9e38">&#9670;&nbsp;</a></span>ruby_vm_at_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ruby_vm_at_exit </td>
          <td>(</td>
          <td class="paramtype">void(*)(<a class="el" href="../../db/d74/structrb__vm__struct.html">ruby_vm_t</a> *)&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ruby_vm_at_exit registers a function <em>func</em> to be invoked when a VM passed away. </p>
<p >Functions registered this way runs in reverse order of registration, just like END {} block does. The difference is its timing to be triggered. ruby_vm_at_exit functions runs when a VM <em>passed</em> <em>away</em>, while END {} blocks runs just <em>before</em> a VM <em>is</em> <em>passing</em> <em>away</em>.</p>
<p >You cannot register a function to another VM than where you are in. So where to register is intuitive, omitted. OTOH the argument <em>func</em> cannot know which VM it is in because at the time of invocation, the VM has already died and there is no execution context. The VM itself is passed as the first argument to it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">func</td><td>the function to register. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/de9/vm_8c_source.html#l00699">699</a> of file <a class="el" href="../../de/de9/vm_8c_source.html">vm.c</a>.</p>

</div>
</div>
<a id="a64b7830f0ac2f5c4e03c3659051b3e4b" name="a64b7830f0ac2f5c4e03c3659051b3e4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64b7830f0ac2f5c4e03c3659051b3e4b">&#9670;&nbsp;</a></span>ruby_vm_destruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ruby_vm_destruct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d74/structrb__vm__struct.html">ruby_vm_t</a> *&#160;</td>
          <td class="paramname"><em>vm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructs the passed VM. </p>
<p >You don't have to call this API directly now, because there is no way to create one. There is only one VM at one time. <a class="el" href="../../de/d43/group__embed.html#ga0b321575afd639286fa2fb5eb46ab64d" title="Calls ruby_cleanup() and exits the process.">ruby_stop()</a> should just suffice. </p>

<p class="definition">Definition at line <a class="el" href="../../de/de9/vm_8c_source.html#l02778">2778</a> of file <a class="el" href="../../de/de9/vm_8c_source.html">vm.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
